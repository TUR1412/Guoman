# 变更提案: R14 UI/UX - AnimeDetail 模块化与表单输入一致性

## 需求背景

- `src/components/AnimeDetail.jsx` 体积过大（> 1100 行），同时承担视觉样式、页面逻辑、交互动作、评论表单等多重职责，维护成本高、回归风险高。
- 页面内存在多处自定义输入控件（进度输入/评论昵称/评论内容等），样式与交互分叉，难以保持一致的 focus、禁用态与可访问性体验。
- 项目已引入并落地 UI primitives（`Button` / `IconButton` / `TextField` 等），需要继续扩展并在关键页面深化使用，形成真正的设计系统闭环。

## 变更内容

1. **AnimeDetail 渐进式模块化**：将「样式」「渲染结构」与「页面状态/事件处理」解耦，拆分为 `src/components/anime/detail/` 目录下的子模块，降低单文件复杂度。
2. **输入组件一致性增强**：将 AnimeDetail 关键输入（集数输入/评论昵称输入等）迁移到 `TextField`，保持交互语义并统一 focus/状态展示。
3. **结构可读性与可演进性**：将可复用的常量（导航/评分渲染等）与小组件抽离，减少重复渲染与未来迭代摩擦。

## 影响范围

- **模块:**
  - 作品详情页（AnimeDetail）
  - 评论表单与观看进度
  - UI primitives（Design System）
- **文件:**
  - `src/components/AnimeDetail.jsx`（对外路由与导出保持不变）
  - `src/components/anime/detail/*`（新增：模块化子组件/样式组织）
  - `src/ui/TextField.jsx`（复用增强：适配更多场景）

## 核心场景

### 需求: 作品详情页稳定展示

**模块:** AnimeDetail

#### 场景: 用户打开作品详情页并浏览信息

- 预期结果: 作品封面/标题/元信息/标签/角色/制作人员/相关推荐/评论区正常展示；加载态与未找到态稳定。

### 需求: 观看进度记录稳定

**模块:** AnimeDetail / watchProgress

#### 场景: 用户调整集数/拖动进度条并快速设置“看到一半/追到最新/清空”

- 预期结果: 进度持久化正常、提示反馈正常、不会引入异常渲染或交互回归。

### 需求: 评论发布与本地清理可用

**模块:** AnimeDetail / commentsStore

#### 场景: 用户填写昵称（可选）与评论内容并提交/清空本地评论

- 预期结果: 输入体验一致（focus 清晰、placeholder/禁用态符合 tokens），提交与清理动作按既有逻辑工作。

## 风险评估

- **风险:** 大文件拆分导致 import/样式引用遗漏，引发运行时报错。
  - **缓解:** 每完成一个子模块拆分即运行 `npm run check`；保持对外导出与 props 结构不变。
- **风险:** 输入组件迁移导致布局/对齐细节变化。
  - **缓解:** 仅替换最关键的单行输入；以“视觉近似 + 交互一致”为优先；保持原有 aria 语义与表单行为。
